<html>

<head>
<title> ShareTechnote </title>
<meta name="generator" content="Namo WebEditor">
</head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<table border="0" width="800">
    <tr>
        <td width="897">
            <p><b><font face="Verdana"><span style="font-size:14pt;">PDCP &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font></b><font face="Verdana"><span
style="font-size:8pt;">Home : <a href="http://www.sharetechnote.com" target="_blank">www.sharetechnote.com</a></span></font></p>
        </td>
    </tr>
    <tr>
        <td width="897">
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center">&nbsp;</p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><font face="Verdana"><span style="font-size:10pt;">
			
<script type="text/javascript"><!--
google_ad_client = "ca-pub-9961293861045757";
/* Horiz_Wide_LTE_PDCP_01 */
google_ad_slot = "4996042372";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center">&nbsp;</p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left"><font face="Verdana"><span style="font-size:10pt;">I would say PDCP is a kind of interface between inside world and outside world. By &quot;Inside World&quot;, I roughly mean &quot;Network Access Network(mainly eNodeB) and Controller for eNodeB&quot;, &quot;Network Emulator Hardware and internal firmware&quot;, and &quot;Mobile Device (UE)&quot;. </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left"><span style="font-size:10pt;"><font face="Verdana"><font face="Verdana">&nbsp;</font></font></span><font face="Verdana"><span style="font-size:10pt;"></span></font></p>
            <ul>
                <li align="left" style="line-height:100%; margin-top:0; margin-bottom:0;">
                    <div align="left"><font face="Verdana"><span style="font-size:10pt;"><a href="#Overview">Overview</a></span></font></div>
                                                                                                                                </li>
                <li align="left" style="line-height:100%; margin-top:0; margin-bottom:0;">
                    <div align="left"><font face="Verdana"><span style="font-size:10pt;"><a href="#PDCP_Data_Structure">PDCP Data Structure</a></span></font></div>
                                                                                                                                </li>
                <li align="left" style="line-height:100%; margin-top:0; margin-bottom:0;">
                    <div align="left"><font face="Verdana"><span style="font-size:10pt;"><a href="#Integrity_Protection_Process">Integrity Protection Process</a></span></font></div>
                                                                                                                                </li>
            </ul>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left"><font face="Verdana"><span style="font-size:10pt;"><b><a name="Overview">Overview</a></b></span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left"><font face="Verdana"><span style="font-size:10pt;">The data coming into the box (or UE) first go through PDCP and then gets into RLC. Data waiting in RLC trying to go out to the outside world has to go through PDCP to outer world. </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">As in other layers, let's start looking into the diagram from 3GPP specification (TS 36.323). The first diagram is as follows. </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">What are we supposed to do ? </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">Yes, Verbalize it (describe it). </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left"><font face="Verdana"><span style="font-size:10pt;">In the following diagram, you see that PDCP is directly connected to RLC Layer (RLC UM and RLC AM). </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left"><font face="Verdana"><span style="font-size:10pt;">Do you find anything strange or missing ? </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left"><font face="Verdana"><span style="font-size:10pt;">Yes, PDCP has no connection to RLC TM mode, meaning RLC TM mode data does not go through PDCP.</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left">&nbsp;</p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="left"><font face="Verdana"><span style="font-size:10pt;"></span></font></p>
            <p align="center" style="line-height:100%; margin-top:0; margin-bottom:0;"><img src="../image/36_323_Fig_4_2_1_1_%20PDCP_Overview.PNG" width="721" height="442" border="0"><font face="Verdana"><span style="font-size:10pt;"></span></font></p>
            <p align="left" style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;"></span></font></p>
            <p align="left" style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;"></span></font></p>
            <p align="left" style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;"></span></font></p>
            <p align="left" style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;"></span></font></p>
            <p align="left" style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;"></span></font></p>
            <p align="left" style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;"></span></font></p>
            <p align="left" style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;"></span></font></p>
            <p align="left" style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;"></span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">Following Diagram would give you more detailed information about PDCP Operation. Of course, all of the these functionality is listed in the 3GPP specification, but it would not become yours unless you combine these diagrams and the descriptions in the specification. </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">Now let's follow through the diagram from left side. </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">i) Data coming into PDCP first go through &quot;Sequence Numbering&quot; Procedure. It means that PDCP add &quot;Sequence Number&quot; to each of incoming data block. Once it add 'Sequence Number', it has to manage the number. On reciever side, we can figure out many things like &quot;Is the data getting delivered in order ? Is there any duplicate data ? How can I combine the multiple chunks
of data block into an original big chunk data ?&quot;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">ii) Then it goes through Header Compression. But it says &quot;this applies only to U-plane data&quot;. It means that Signaling Message does not go through this Header Compression. Even though not shown in this diagram, we can disable Header Compression even for U-plane data (e.g, IP Packet data).</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">iii) From here we see two paths, one through &quot;Integrity/Ciphering&quot; and the other one directly goes to the last step. Integrity Protection applies only to C-Plane data (C-Plane data means RRC/NAS message, i.e DCCH data, not DTCH data). Again you can disable &quot;Integrity Protection&quot; setp by applying IEA0 to this process.</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">iv) Then it goes to Ciphering process. Ciphering applies both C-Plane and U-Plane Data. Ciphering process can also be disabled by applying EEA0.</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">v) Eventually at the last step of transmission PDCP, a header is added and get out of PDCP layer. </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">The other side (right side, receiving side) is simply reverse process of transmission process. So I will leave this to the readers to interpret the diagram.</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><img src="../image/36_323_Fig_4_2_2_1_%20PDCP_Overview.PNG" width="597" height="532" border="0"></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt; line-height:100%;"><b><a name="PDCP_Data_Structure">PDCP Data Structure</a></b></span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt; line-height:100%;">As in MAC PDU, RLC PDU.. PDCP also has it's own data structure and again you would never understand this structure in detail unless you get some real data and anlayze the data manually. But putting all together the following diagram (from 3GPP 36.323) would guide you to decode PDCP Data. </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;">&nbsp;</p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt; line-height:100%;">The only key question when you try to decode real PDCP data would be &quot;Which diagram I have to use to decode this data ?&quot;. Only practice would give you the quick answer. </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;">&nbsp;</p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt; line-height:100%;">First Let's briefly look at the data structure. Following is the data structure for SRB. It means all the C plane data (RRC/NAS message) use this data structure. As you see, the first three bits are reserved. and next comes 5 bits PDCP SN(Sequence Number) and at the end of the block 4 bytes of MAC-I data is attached.</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><img src="../image/36_323_Fig_6_2_2_1_PDCP_PDU_SRB.PNG" width="378" height="344" border="0"></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt; line-height:100%;">Following two diagram shows the PDCP structure for DRB. It means U-Plane data, DTCH data is using this kind of data structure. The only differences between these two data type is the size of SN (Sequence Number). One is using 7 bit and the other is 12 bits. </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt; line-height:100%;">Comparing to SRB PDCP structure, you would find two differences. D/C bit at the first bit of the structure. This tells you whether the PDCP data is for user data or PDCP control data (This control data does not mean C-Plane data. It is control data being used in PDCP layer). And the other difference is that you do not have the MAC-I at the end of the data. MAC-I is the special
information for Integrity protection. Do you remember Integrity Protection applies only to C-Plane data, not to U-Plane data&nbsp;? </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><img src="../image/36_323_Fig_6_2_4_1_PDCP_PDU_DRB_7Bit.PNG" width="595" height="220" border="0"></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><img src="../image/36_323_Fig_6_2_3_1_PDCP_PDU_DRB_12Bit.PNG" width="505" height="236" border="0"></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">Following two data structure is a kind of PDCP layer control packet.</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><img src="../image/36_323_Fig_6_2_5_1_PDCP_ROHC_Feedback.PNG" width="669" height="195" border="0"></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><img src="../image/36_323_Fig_6_2_6_1_PDCP_ControlPDU.PNG" width="545" height="276" border="0"></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt; line-height:100%;">All of the following tables shows the meaning of each data field shown in the diagrams we saw above. You will refer to this table a lot when you try to decode PDCP data yourself. Otherwise, you would read now and forget as your click to another page.</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><img src="../image/36_323_Fig_6_3_2_1_PDCP_SN_Length.PNG" width="497" height="119" border="0"></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><img src="../image/36_323_Fig_6_3_7_1_PDCP_DC_Field.PNG" width="475" height="104" border="0"></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><img src="../image/36_323_Fig_6_3_8_1_PDCP_PDU_Type.PNG" width="474" height="134" border="0"></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><img src="../image/36_323_Fig_6_3_10_1_PDCP_Bitmap.PNG" width="466" height="206" border="0"></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt; line-height:100%;"><b><a name="Integrity_Protection_Process">Integrity Protection Process</a></b></span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">My perception of any process is &quot;a black box that convert a set of inputs into a set of output&quot;. So for any process, I usually tries to define what is the inputs and out is the final outputs.. and then try to find the all of the steps one by one to convert the input into the outputs. </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;">&nbsp;</p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">If I define LTE Integrity Protection Procedure with this logic, it would be &quot;a process that convert 'K' value from USIM into PDCP MAC-I and NAS MAC(Message Authentication Code)&quot;. Describing this process with illustration would be as follows. Just try to go through this illustration whenever you have chance and try to have your own idea first. </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">The process described here apply only to C-Plane data. (Refer to 33.401 for the detailed description of each of the steps). </span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;" align="center"><img src="../image/Security_Integrity.PNG" width="498" height="483" border="0"></p>
            <p style="line-height:100%; margin-top:0; margin-bottom:0;"><font face="Verdana"><span style="font-size:10pt;">&nbsp;</span></font></p>
            <p>&nbsp;</p>
        </td>
    </tr>
</table>
<p>&nbsp;</p>
</body>

</html>